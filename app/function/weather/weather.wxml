<wxs src="./weather.wxs" module="tool" />
<view class="wrapper grey">
  <view
    class="weather-wrapper {{night? 'night': 'day'}}"
    style="padding-top: {{info.statusBarHeight}}px;"
  >
    <view
      class="back-button"
      style="top: {{info.statusBarHeight + 5.5}}px;"
      hover-class="button-hover"
      catch:tap="back"
    >
      <image
        class="back-icon"
        src="/icon/{{firstPage? 'home': 'back'}}{{darkmode? 'White': ''}}.svg"
      />
    </view>
    <button
      class="button share icon-forwardfill"
      hover-class="button-hover"
      hover-start-time="0"
      open-type="share"
      plain
    >
      分享
    </button>

    <!-- 背景蒙层 -->
    <view class="background">
      <view class="layer layer1" animation="{{animation1}}" />
      <view class="layer layer2" animation="{{animation2}}" />
      <view class="layer layer3" animation="{{animation3}}" />
    </view>
    <view class="quality level{{weather.air.aqiLevel || 1}}">
      <view class="number">{{weather.air.aqi}}</view>
      <view class="level">{{weather.air.aqiName}}</view>
    </view>
    <view class="location icon-location">长春市 南关区</view>
    <view class="temperature">{{weather.observe.degree}}°</view>
    <view class="type">{{weather.observe.weather}}</view>
    <view class="detail">湿度 {{weather.observe.humidity}}%</view>
    <view class="detail"
      >{{weather.observe.windDirection}}风 {{weather.observe.windPower}}级</view
    >
    <view class="tip" catch:tap="refresh"
      >{{weather.tips.observe[tipIndex]}}</view
    >
  </view>
  <view class="forecast borderB">
    <view class="item">
      <view class="top">
        <text class="date">今天</text>
        <text class="temperature"
          >{{tool.getTemperature(weather.dayForecast[1])}}</text
        >
      </view>
      <view class="bottom">
        <text class="weather">{{tool.getWeather(weather.dayForecast[1])}}</text>
        <image
          class="icon"
          src="{{tool.getIcon(weather.dayForecast[1].dayWeatherCode)}}"
        />
      </view>
    </view>
    <view class="item">
      <view class="top">
        <text class="date">明天</text>
        <text class="temperature"
          >{{tool.getTemperature(weather.dayForecast[2])}}</text
        >
      </view>
      <view class="bottom">
        <text class="weather">{{tool.getWeather(weather.dayForecast[2])}}</text>
        <image
          class="icon"
          src="{{tool.getIcon(weather.dayForecast[2].dayWeatherCode)}}"
        />
      </view>
    </view>
  </view>
  <!-- 小时预报 -->
  <scroll-view class="hours borderTB" enable-flex scroll-x>
    <view wx:for="{{weather.hourForecast}}" wx:key="update_time" class="item">
      <text class="time">{{item.time}}</text>
      <image class="icon" src="{{tool.getIcon(item.weatherCode)}}" />
      <text class="degree">{{item.degree}}°</text>
    </view>
  </scroll-view>
  <!-- 日预报 -->
  <scroll-view class="days borderTB" enable-flex scroll-x>
    <view wx:for="{{weather.dayForecast}}" class="item" wx:key="weekday">
      <view class="day">{{item.weekday}}</view>
      <view class="date">{{item.date}}</view>
      <view class="weather">{{item.dayWeatherShort}}</view>
      <image class="icon" src="{{tool.getIcon(item.dayWeatherCode)}}" />
      <view class="placeholder" />
      <image class="icon" src="{{tool.getIcon(item.nightWeatherCode)}}" />
      <view class="weather">{{item.nightWeatherShort}}</view>
      <view class="wind">{{item.nightWindDirection}}</view>
      <view class="wind">{{item.nightWindPower}}级</view>
    </view>
    <!-- 温度曲线 -->
    <canvas type="2d" class="canvas temperature" canvas-id="weather" />
  </scroll-view>
  <!-- 其他信息 -->
  <view class="info">
    <view class="item borderR">
      <text class="icon icon_xianhao" />
      <view class="content">{{weather.limit.tail_number }}</view>
      <view class="title">尾号限行</view>
    </view>
    <view class="item">
      <text class="icon icon_chuanyi_hot" />
      <view class="content">{{weather.index.clothes.info}}</view>
      <view class="title">{{weather.index.clothes.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_yusan" />
      <view class="content">{{weather.index.umbrella.info}}</view>
      <view class="title">{{weather.index.umbrella.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_ganmao" />
      <view class="content">{{weather.index.cold.info}}</view>
      <view class="title">{{weather.index.cold.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_xiche" />
      <view class="content">{{weather.index.carwash.info}}</view>
      <view class="title">{{weather.index.carwash.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_yundong" />
      <view class="content">{{weather.index.sports.info}}</view>
      <view class="title">{{weather.index.sports.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_fangsai" />
      <view class="content">{{weather.index.sunscreen.info}}</view>
      <view class="title">{{weather.index.sunscreen.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_diaoyu" />
      <view class="content">{{weather.index.fish.info}}</view>
      <view class="title">{{weather.index.fish.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_lvyou" />
      <view class="content">{{weather.index.tourism.info}}</view>
      <view class="title">{{weather.index.tourism.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_jiaotong" />
      <view class="content">{{weather.index.traffic.info}}</view>
      <view class="title">{{weather.index.traffic.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_wurankuosan" />
      <view class="content">{{weather.index.diffusion.info}}</view>
      <view class="title air">{{weather.index.diffusion.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_shushidu" />
      <view class="content">{{weather.index.comfort.info}}</view>
      <view class="title">{{weather.index.comfort.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_liangshai" />
      <view class="content">{{weather.index.drying.info}}</view>
      <view class="title">{{weather.index.drying.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_huazhuang" />
      <view class="content">{{weather.index.makeup.info}}</view>
      <view class="title">{{weather.index.makeup.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_chenlian" />
      <view class="content">{{weather.index.morning.info}}</view>
      <view class="title">{{weather.index.morning.name}}</view>
    </view>
    <view class="item">
      <text class="icon icon_guomin" />
      <view class="content">{{weather.index.allergy.info}}</view>
      <view class="title">{{weather.index.allergy.name}}</view>
    </view>
  </view>
</view>
